test_swap_emitsSwapFailed